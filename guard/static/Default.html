<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=7,9,10,11">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">

    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/font-awesome.css">
    <link rel="stylesheet" type="text/css" href="my_define.css">
    <link rel="stylesheet" type="text/css" href="./keyboard.css">
    <link rel="stylesheet" type="text/css" href="./password.css">
    <link rel="stylesheet" type="text/css" href="./css/buttons.css">

    <script type="text/javascript" src="js/jquery-3.1.1.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
	<script type="text/javascript" src="md5.js"></script>

</head>

<body style="left: 0px; top: 0px; width: 800px; height: 480px; ">

<audio id='system_audio_click'  src="sounds/click.ogg" type="audio/ogg" preload="auto" ></audio>
<audio id='system_audio_error'  src="sounds/error.ogg" type="audio/ogg" preload="auto" ></audio>
<audio id='system_audio_time_warning'  src="sounds/time_warning.ogg" type="audio/ogg" preload="auto" ></audio>
<audio id='system_audio_alerm'  src="sounds/alerm.ogg" type="audio/ogg" preload="auto" loop></audio>
<audio id='system_audio_bell_ring'  src="sounds/bell_ring.ogg" type="audio/ogg" preload="auto" loop ></audio>

<audio id='system_audio' preload="auto" autoplay>    您的浏览器不支持 audio 标签。</audio>

<script type="text/javascript">


function audio_system_play_click(){
	document.getElementById("system_audio_click").play();
}
function audio_system_play_error(){
	document.getElementById("system_audio_error").play();
}
function audio_system_play_time_warning(){
	document.getElementById("system_audio_time_warning").play();
}
function audio_system_play_alerm(){
	document.getElementById("system_audio_alerm").play();
}
function audio_system_play_bell_ring(){
	document.getElementById("system_audio_bell_ring").play();
}

function audio_system_load(url) {
	document.getElementById("system_audio").pause();
    document.getElementById("system_audio").src = url; //move to html for preload 
}
function audio_system_play(url) {
	console.log("audio system play",url );
    document.getElementById("system_audio").src = url; //move to html for preload 
    document.getElementById("system_audio").loop = false;
    //document.getElementById("system_audio").play();
}
function audio_system_play_loop(url) {
    document.getElementById("system_audio").src = url; //move to html for preload 
    document.getElementById("system_audio").loop = true;  
    //document.getElementById("system_audio").play();
}
function audio_system_stop_all(){
	document.getElementById("system_audio_click").pause();	
	document.getElementById("system_audio_error").pause();
	document.getElementById("system_audio_time_warning").pause();
	document.getElementById("system_audio_alerm").pause();
	document.getElementById("system_audio_bell_ring").pause();
	document.getElementById("system_audio").pause();
	document.getElementById("system_audio_time_warning").src = document.getElementById("system_audio_time_warning").src  ;
}
</script>


<div id="body" class="clearfix  ">
    <div class="row">

        <div style="position:absolute;  left:0px; width: 640px;">
            <img src="bg.png"/>
            <div style="position:absolute;  left:477px; top:92px; opacity: 1"><i class="fa fa-grav fa-spin "
                                                                                 aria-hidden="true"></i></div>
            <div style="position:absolute;  left:490px; top:380px; opacity: 1"><i class="fa fa-grav fa-spin "
                                                                                  aria-hidden="true"></i></div>

            <div style="position:absolute;  left:663px; top:378px; opacity: 1"><i
                    class="fa fa-thermometer-full fa-spin " aria-hidden="true"></i></div>
            <div style="position:absolute;  left:693px; top:378px; opacity: 1"><i class="fa fa-shower fa-spin "
                                                                                  aria-hidden="true"></i></div>

            <div style="position:absolute;  left:770px; top:378px; opacity: 1"><i class="fa fa-window-maximize fa-spin "
                                                                                  aria-hidden="true"></i></div>
            <div style="position:absolute;  left:770px; top:92px; opacity: 1"><i class="fa fa-window-maximize fa-spin "
                                                                                 aria-hidden="true"></i></div>


            <div style="position:absolute;  left:53px; top:117px; opacity: 1"><i class="fa fa-wpexplorer fa-spin "
                                                                                 aria-hidden="true"></i></div>
            <div style="position:absolute;  left:178px; top:368px; opacity: 1"><i
                    class="fa fa-assistive-listening-systems fa-spin " aria-hidden="true"></i></div>
            <div style="position:absolute;  left:272px; top:260px; opacity: 1"><i
                    class="fa fa-exclamation-triangle fa-spin " aria-hidden="true"></i></div>

        </div>
    </div>

    <div style="width: 160px;">
        <div style="height:  300px;"></div>
        <div class="pull-right">
            <button type="button" class="btn btn-default btn-lg" style="z-order:2;">
                <span class="glyphicon glyphicon-star" aria-hidden="true"></span>设防
            </button>
        </div>
    </div>

</div>
<!-- debug row
<div class="row">
  <div class="col-sm-1">DEBUG nav:</div>
  <div class="col-sm-11">
    <div style="height:  80px;"> </div>
    <button class="btn btn-success" data-toggle="modal" data-target="#DisabledPopup"  >protect_check</button>
    <button class="btn btn-success" data-toggle="modal" data-target="#testPopup"  >protect_starting</button>
    <button class="btn btn-success" onclick="show_protect_check_win();">protected</button>
    <button class="btn btn-success" >protect_unlock</button>
    <button class="btn btn-success" >bell_view</button>
    <button class="btn btn-success" >warning_view</button>
    <button class="btn btn-success" >devicelist</button>
    <button class="btn btn-success" >pasawd_view</button>
    <div id="log"></div>
 </div>
</div>
debug row end-->
</div>


<!--  layer 2 protect_check -->
<div class="modal fade" id="protect_check" >
    <div class="modal-dialog"
         style="position:absolute; margin-top:0px; left:0px; top:0px; width:800px; height:480px; background:#000;opacity: 1">
        <!--<div class="" style="padding: 10px;">-->
        <div id="" class="dlg-hd ">
            <div class="row" style=" width: 800px; ">
                <div id="title" style="display:inline; height:50px;">
                    <div id="logo" class="pi-pilog-icon" style=" margin-left:38px;"></div>

                    <div id="btns" class="pull-right" style="display:inline; height:50px;margin-right=30px">
                        <!-- img
                                        <button id="btn3" class="button-inverse pi-flat-btn" style="width:100px" data-toggle="modal" data-target="#" data-backdrop="static">
                                            <div>
                                                <img src="images/icon_device.png"   style="display:inline;margin-top: -6px;" ></img>
                                                <font color="#56baca" face="兰亭黑" style="font-size:16px;" >设备</font>
                                            </div>
                                        </button>
                        -->
                        <button id="btn1" class="button-inverse pi-flat-btn" style=" width:100px" data-toggle="modal"
                                data-target="#devices_view" data-backdrop="static">
                            <div class="pi-device-icon">
                                <div style="position:relative;font-size:16px;margin-left:18px; margin-top: -3px;">
                                    <font color="#56baca" face="兰亭黑">设备</font>
                                </div>
                            </div>
                        </button>

                        <button id="btn2" class="button-inverse pi-flat-btn" style=" width:100px" data-toggle="modal"
                                data-target="#change_password" data-backdrop="static">
                            <div class="pi-password-icon">
                                <div style="position:relative;font-size:16px;margin-left:18px; margin-top: -3px;">
                                    <font color="#56baca" face="兰亭黑">密码</font>
                                </div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            <div style="height:40px;"></div>

            <table>
                <tr>
                    <td style=" width: 42px; "></td>
                    <td style=" width:480px; ">
                        <div class="panel panel-pi "
                             style="display:block;width:100%;border-width:1px;background-color:#343434">

                            <div class="panel-heading " style="display:block;">
					<span> 
					<font color="#ffffff" face="兰亭黑"
                          style="position:relative;font-size:20px;margin-left:30px;margin-top:30px;">状态:未设防</font>
				</span></div>
                            <div class="panel-body " style=" height:  300px;background-color:#343434">
                                <div id="warnning_sets" style="background-color:#343434">
                                    <ul id="protect_check_ul">


                                    </ul>
                                </div>
                            </div>
                        </div>
                    </td>
                    <td style=" width:278px; text-align:center;margin:auto;vertical-align:middle">
                        <div class="btn-group-vertical" role="group">
                            <button id="protect_check_btn_outgoing" class=" button  button-circle pi-out-icon "
                                    style="margin-top:26px;"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:24px;margin:auto;">外出</font></div>

                            <button id="protect_check_btn_indoors" class="button  button-circle pi-home-icon"
                                    style="margin-top:26px;"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:24px;margin:auto;">居家</font></div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
</div>

</div>
<!--  layer 2 end protect_check-->


<!--  layer 2  protect_starting -->
<div class="modal fade" id="protect_starting" >
    <div class="modal-dialog"
         style="position:absolute; margin-top:0px; left:0px; top:0px; width:800px; height:480px; background:#000;opacity: 1">
        <!--<div class="" style="padding: 10px;">-->
        <div id="" class="dlg-hd ">
            <div class="row" style=" width: 800px; ">
                <div id="title" style="display:inline; height:50px;">
                    <div id="logo" class="pi-pilog-icon" style=" margin-left:38px;"></div>

                    <div id="btns" class="pull-right" style="display:inline; height:50px;margin-right=30px">


                        <button id="btn1" class="button-inverse pi-flat-btn" style=" width:100px" data-toggle="modal"
                                data-target="#devices_view" data-backdrop="static">
                            <div class="pi-device-icon">
                                <div style="position:relative;font-size:16px;margin-left:18px; margin-top: -3px;">
                                    <font color="#56baca" face="兰亭黑">设备</font>
                                </div>
                            </div>
                        </button>

                        <button id="btn2" class="button-inverse pi-flat-btn" style=" width:100px" data-toggle="modal"
                                data-target="#change_password" data-backdrop="static">
                            <div class="pi-password-icon">
                                <div style="position:relative;font-size:16px;margin-left:18px; margin-top: -3px;">
                                    <font color="#56baca" face="兰亭黑">密码</font>
                                </div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            <div style="height:40px;"></div>

            <table style=" height:380px">
                <tr>
                    <td class="col-sm-1" style="width:42px; "></td>
                    <td class="col-sm-1" style="width:480px; ">
                        <div class=""
                             style="/*border: 1; border-color: #00FF00; border-style: solid; border-width: 3px; */margin:auto; text-align:center">
                            <img style="position:absolute;left:104px; top:90px;margin-top:0px;margin-left:0px z-order:1"
                                 src="images/table2.png"/>

                            <img style="position:absolute;left:160px; top:150px; margin-top:0px;margin-left:0px;z-order:2"
                                 src="images/gif3.gif"/>

                            <div style="position:absolute; margin-top:0px; left:133px; top:390px; z-order:2;">
                                <span id='protect_starting_status' class='protect_starting_status'></span>
                            </div>


                            <div style="position:absolute; margin-top:0px; left:212px; top:168px; z-order:3; ">
                                <span id='protect_starting_timeremain' class='protect_starting_timeremain'></span>
                            </div>

                            <div style="position:absolute; margin-top:0px; left:288px; top:202px; z-order:3; ">
                                <font color="#56baca" face="兰亭黑" style="font-size:24px;margin:auto;">s</font>
                            </div>

                        </div>

                    </td>
                    <td class="col-sm-1" style=" width:278px;margin:auto; text-align:center; vertical-align:middle">
                        <div class="btn-group-vertical" role="group" aria-label="...">
                            <button id='protect_starting_btn-cancel' class="button  button-circle pi-cancel_hover-icon"
                                    style="width:114px; height:114px; margin-top:26px;"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:24px;margin:auto;">取消</font></div>
                        </div>

                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
</div>

</div>
<!--  layer 2 end  protect_stating-->

<!--  layer 2 protected-->

<div class="modal fade" id="protected" >
    <div class="modal-dialog"
         style="position:absolute; margin-top:0px; left:0px; top:0px; width:800px; height:480px; background:#000;opacity: 1">
        <!--<div class="" style="padding: 10px;">-->
        <div id="" class="dlg-hd ">
            <div class="row" style=" height:50px">
                <div id="title" style="display:inline; height:50px;">
                    <div id="logo" class="pi-pilog-icon" style=" margin-left:38px;"></div>


                </div>
            </div>


            <table style=" height:430px">
                <tr>
                    <td class="col-sm-1" style="width:42px; "></td>
                    <td class="col-sm-1" style="width:480px; ">
                        <div class=""
                             style="/*border: 1; border-color: #00FF00; border-style: solid; border-width: 3px; */margin:auto; text-align:center">
                            <img style="position:absolute;left:104px; top:90px;margin-top:0px;margin-left:0px z-index:1"
                                 src="images/table3.png"/>

                            <img style="position:absolute;left:160px; top:150px; margin-top:0px;margin-left:0px;z-index:2"
                                 src="images/gif1.gif"/>

                            <div style="position:absolute; margin-top:0px; left:145px; top:390px; z-order:2;">
                                <span id='protected_status' class='protected_status'></span>
                            </div>


                        </div>

                    </td>
                    <td class="col-sm-1" style=" width:278px;margin:auto; text-align:center; vertical-align:middle">
                        <div class="btn-group-vertical" role="group" aria-label="...">
                            <button id="protected_btn-cancel" class="button  button-circle pi-cancel_hover-icon"
                                    style="margin-top:26px;"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:24px;margin:auto;">撤防</font></div>
                        </div>

                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
</div>

</div>
<!--  layer 2 end protected-->


<!--  layer 2 unlock_protect -->

<div class="modal fade" id="unlock_protect" >
    <div class="modal-dialog"
         style="position:absolute; margin-top:0px; left:0px; top:0px; width:800px; height:480px; background:#000;opacity: 1">
        <!--<div class="" style="padding: 10px;">-->
        <div id="" class="dlg-hd ">
            <div class="row" style=" width: 800px; ">
                <div id="title" style="display:inline; height:50px;">
                    <div id="logo" class="pi-pilog-icon" style=" margin-left:38px;"></div>

                    <div id="btns" class="pull-right" style="display:inline; height:50px;margin-right=30px">

                    </div>
                </div>
            </div>
            <table style="height:427px;margin-left:0px ">
                <tr>
                    <td class="col-sm-1"
                        style="width:526px; text-align:center ; vertical-align:top /*border-color: #00FF00; border-style: solid; border-width: 1px;*/">

                        <!-- div  style="/*border: 1; border-color: #00FF00; border-style: solid; border-width: 3px;*/ margin:auto; text-align:center" -->

                        <div style="position:relative;    margin:auto;  margin-top:58px;">
                            <font color="#56baca" face="兰亭黑" style="font-size:24px;margin:auto;">请输入撤防密码</font>
                        </div>

                        <div id="pwd-box" style="position:relative;    margin:auto;  /*margin-top:78px;*/">
                            <input type="tel" maxlength="6" class="pwd-input" id="win_unlock_protect_input">
                            <div id="pwd-box-fake-box">
                                <input type="password" readonly="">
                                <input type="password" readonly="">
                                <input type="password" readonly="">
                                <input type="password" readonly="">
                                <input type="password" readonly="">
                                <input type="password" readonly="">
                            </div>
                        </div>


                        <div style="position:relative;  left:200px; width=100px; text-align:left;  margin:auto;  margin-top:90px;">
                            <div style="position:relative;   margin:auto; display:inline; ">
                                <span id='unlock_protect_remain_seconds' class='unlock_protect_remain_seconds'></span>
                            </div>

                            <div style="position:relative; left:5px; margin:auto;display:inline;  ">
                                <font color="#56baca" face="兰亭黑" style="font-size:28px;margin:auto;">s</font>
                            </div>
                        </div>

                    </td>
                    <td class="col-sm-1" style=" width:278px;margin:auto; text-align:center; vertical-align:middle; ">
                        <!-- keyboard -->
                        <div id="counter">
                            <div id="counter_content">
                                <ul>
                                    <li id="keyboard1"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">1</font></li>
                                    <li id="keyboard2"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">2</font></li>
                                    <li id="keyboard3"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">3</font></li>
                                    <li id="keyboard4"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">4</font></li>
                                    <li id="keyboard5"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">5</font></li>
                                    <li id="keyboard6"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">6</font></li>
                                    <li id="keyboard7"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">7</font></li>
                                    <li id="keyboard8"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">8</font></li>
                                    <li id="keyboard9"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">9</font></li>
                                    <li id="keyboardc"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:24px;margin:auto;">清空</font></li>
                                    <li id="keyboard0"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">0</font></li>
                                    <li id="keyboardd"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:24px;margin:auto;">删除</font></li>

                                </ul>
                            </div>
                            <!-- keyboard -->

                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
</div>

</div>
<!--  layer 2 end unlock_protect-->


<!--  layer 2 alert_message -->
<div class="modal fade" id="alert_message" >
    <div class="modal-dialog"
         style="position:absolute; margin-top:0px; left:0px; top:0px; width:800px; height:480px; background:#000;opacity: 1">
        <!--<div class="" style="padding: 10px;">-->
        <div id="" class="dlg-hd ">
            <div class="row" style=" height:50px">
                <div id="title" style="display:inline; height:50px;">
                    <div id="logo" class="pi-pilog-icon" style=" margin-left:38px;"></div>


                </div>
            </div>


            <table style=" height:430px">
                <tr>
                    <td class="col-sm-1" style="width:42px; "></td>
                    <td class="col-sm-1" style="width:480px; ">
                        <div class=""
                             style="/*border: 1; border-color: #00FF00; border-style: solid; border-width: 3px; */margin:auto; text-align:center">
                            <img style="position:absolute;left:104px; top:90px;margin-top:0px;margin-left:0px z-index:1"
                                 src="images/table5.png"/>

                            <img style="position:absolute;left:165px; top:150px; margin-top:0px;margin-left:0px;z-index:2"
                                 src="images/gif2.gif"/>

                            <div style="position:absolute; margin-top:0px; left:145px; top:390px; z-order:2; text-align:center"
                            " >
                            <span id='alert_message_explain' class='alert_message_explain'></span>

                        </div>


        </div>

        </td>
        <td class="col-sm-1" style=" width:278px;margin:auto; text-align:center; vertical-align:middle">
            <div class="btn-group-vertical" role="group" aria-label="...">
                <button id="alert_message_btn-stopalert" class="button  button-circle pi-stop-alerm-icon"
                        style="width:114px; height:122px; margin-top:26px;"></button>
                <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                    style="font-size:24px;margin:auto;">停止警报</font></div>
            </div>

        </td>
        </tr></table>
    </div>
</div>
</div>
</div>

</div>
<!--  layer 2 end alert_message-->


<!--  layer 2 bell_ring-->

<div class="modal fade" id="bell_ring" >
    <div class="modal-dialog"
         style="position:absolute; margin-top:0px; left:0px; top:0px; width:800px; height:480px; background:#000;opacity: 1">
        <!--<div class="" style="padding: 10px;">-->
        <div id="" class="dlg-hd ">
            <div class="row" style=" height:50px">
                <div id="title" style="display:inline; height:50px;">
                    <div id="logo" class="pi-pilog-icon" style=" margin-left:38px;"></div>


                </div>
            </div>
            <table style=" height:430px">
                <tr>

                    <td class="col-sm-1" style="width:528px;  vertical-align:bottom"
                    ">
                    <div class=""
                         style="/*border: 1; border-color: #00FF00; border-style: solid; border-width: 3px; */margin:auto; text-align:center">
                        <img style="position:absolute;top:50px;left:0px; z-index:1;" src="images/pic_calling.png"/>

                        <div style="position:absolute; top:420px; left:180px; z-index:2;">
                            <span class='protect_starting_status'><font id='bell_ring_description' color="#ffffff"
                                                                        style="buttom:-38px"></font></span>

                        </div>
                    </div>

                    </td>
                    <td class="col-sm-1" style=" width:278px;margin:auto; text-align:center; vertical-align:middle">
                        <div class="btn-group-vertical" role="group" aria-label="...">
                            <button id="bell_ring_startstream" class="button  button-circle pi-talk-icon2"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:20px;margin:auto;">对讲</font></div>

                            <button id="bell_ring_opendoor" class="button  button-circle pi-open_door-icon2"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:20px;margin:auto;">开门</font></div>

                            <button id="bell_ring_reject" class="button  button-circle pi-cancel_hover-icon2"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:20px;margin:auto;">取消</font></div>
                        </div>

                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
</div>

</div>
<!--  layer 2 end  bell_ring-->
<!--  layer 2 bell_view-->
<div class="modal fade" id="bell_view">
    <div class="modal-dialog"
         style="position:absolute; margin-top:0px; left:0px; top:0px; width:800px; height:480px; background:#000;opacity: 1">
        <!--<div class="" style="padding: 10px;">-->
        <div id="" class="dlg-hd ">
            <div class="row" style=" height:50px">
                <div id="title" style="display:inline; height:50px;">
                    <div id="logo" class="pi-pilog-icon" style=" margin-left:38px;"></div>


                </div>
            </div>
            <table style=" height:430px">
                <tr>

                    <td class="col-sm-1" style="width:528px;  vertical-align:bottom">
					 <!-- 
                    <div style="border: 1; border-color: #00FF00; border-style: solid; border-width: 1px;" > </div>
					
                    <video id="bell_view_video" autoplay style="position:absolute; margin:50px 0 0 10px; left:0px; top:0px; width:518px;height:420px ;"> </video>
					
                    -->
                    
					<embed type='application/x-vlc-plugin'  id="bell_view_video_vlc"  autoplay autostart style="position:absolute; margin:50px 0 0 10px; left:0px; top:0px; width:518px;height:420px ;">
					</embed>
					
                    <div style="position:absolute; top:420px; width:528px; z-index:2; text-align:center;/*display:flex;flex-direction:row;align-content:center*/">
						<span ><font id='bell_view_description' face="兰亭黑" style="font-size:28px;margin:auto;buttom:-38px " color="#ffffff">门铃视频中…… </font></span>
                        
                    </div>


                    </td>
                    <td class="col-sm-1" style=" width:278px;margin:auto; text-align:center; vertical-align:middle">
                        <div class="btn-group-vertical" role="group" aria-label="...">


                            <button id="bell_view_opendoor" class="button  button-circle pi-open_door-icon2"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:20px;margin:auto;">开门</font></div>

                            <button id="bell_view_reject" class="button  button-circle pi-cancel_hover-icon2"></button>
                            <div style="margin-top:10px;"><font color="#56baca" face="兰亭黑"
                                                                style="font-size:20px;margin:auto;">取消</font></div>
                        </div>

                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
</div>

</div>
<!--  layer 2 end bell_view-->


</div>

<!-- devices_view view -->
<div class="modal fade" id="devices_view">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <span class="modal-title" id="myModalLabel">设备管理</span>
            </div>
            <div class="modal-body">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>设备ID</th>
                        <th>类型</th>
                        <th>别名</th>
                    </tr>
                    </thead>
                    <tbody id="devices_view_device_tr">
                    </tbody>
                </table>
					<div style="margin:auto;height:48px;width:100%;text-align:center ; vertical-align:bottom; ">
					<ul id="win_devices_view_pager" class="pagination " style="margin:auto;" >

					</ul>
					</div>
            </div>
			<div>
			 
 

			 </div>
        </div>
    </div>
</div>

<div class="modal fade " id="modify_position_name">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="H1">修改设备别名</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" role="form" id="win_modify_position_name_form">

                    <div class="form-group">
                        <label class="col-sm-2 control-label">uuid</label>
                        <div class="col-sm-10">
                            <span id="win-modify_position_name-uuid"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">现名称</label>
                        <div class="col-sm-10">

                            <input type="text" id="win-modify_position_name-oldname" class="form-control"
                                   readonly="readonly"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">新名称</label>
                        <div class="col-sm-10">
                            <input type="text" maxlength="8" class="form-control" id="win_modify_position_name_Newname">
                        </div>
                    </div>


                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" id="win_modify_position_name_submit" data-toggle="modal" >保存修改
                </button>
                <!--button type="button" class="btn btn-danger" id="btnCancel" data-dismiss="modal">Cancel</button-->
            </div>

        </div>
    </div>
</div>



<div class="modal fade" id="change_password">
    <div class="modal-dialog" style=" width: 600px; top:20px; z-index=1600 ">


        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <span class="modal-title" id="myModalLabel">密码修改</span>
            </div>
            <table style="margin-left:0px ">
                <tr>
                    <td style=" width:360px; height:330px; text-align:center ; vertical-align:top;">


                        <div style="position:relative;    margin:auto;  margin-top:58px;">
                            <span id="win_change_password_stepprompt" color="#56baca" face="兰亭黑" style="font-size:24px;margin:auto;"></span>
                        </div>

                        <div id="pwd-box"
                             style="position:relative; width:100%!important;  margin:auto;  margin-top:20px;">
                            <input type="tel" maxlength="6" class="pwd-input" id="win_change_password_input">
                            <div id="pwd-box-fake-box">
                                <input style=" margin-left:4px!important;background-color:#fff!important;" type="password" readonly="">
                                <input style=" margin-left:4px!important;background-color:#fff!important;" type="password" readonly="">
                                <input style=" margin-left:4px!important;background-color:#fff!important;" type="password" readonly="">
                                <input style=" margin-left:4px!important;background-color:#fff!important;" type="password" readonly="">
                                <input style=" margin-left:4px!important;background-color:#fff!important;" type="password" readonly="">
                                <input style=" margin-left:4px!important;background-color:#fff!important;" type="password" readonly="">
                            </div>
                        </div>

                    </td>
                    <td style=" width:278px;margin:auto; text-align:center; vertical-align:middle; ">
                        <!-- keyboard -->
                        <div id="counter" style="height:100%!important;  ">
                            <div id="counter_content" style="top:0px;!important;">
                                <ul>
                                    <li id="keyboard1"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">1</font></li>
                                    <li id="keyboard2"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">2</font></li>
                                    <li id="keyboard3"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">3</font></li>
                                    <li id="keyboard4"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">4</font></li>
                                    <li id="keyboard5"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">5</font></li>
                                    <li id="keyboard6"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">6</font></li>
                                    <li id="keyboard7"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">7</font></li>
                                    <li id="keyboard8"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">8</font></li>
                                    <li id="keyboard9"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">9</font></li>
                                    <li id="keyboardc"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:24px;margin:auto;">清空</font></li>
                                    <li id="keyboard0"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:28px;margin:auto;">0</font></li>
                                    <li id="keyboardd"><font color="#56baca" face="兰亭黑"
                                                             style="font-size:24px;margin:auto;">删除</font></li>

                                </ul>
                            </div>
                            <!-- keyboard -->

                    </td>
                </tr>
            </table>

        </div>
    </div>
</div>



<div class="modal fade" id="Popup_info" style="z-index=2000; width:800px; height:460px; ">
    <div class="modal-dialog" style="z-index=2000;  ">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="H2">提示</h4>
            </div>
            <div class="modal-body" style="margin: 0 auto;  text-align:left;">
                <div id="Popup_info_prompt" style="margin: 0 auto; left=80px"></div>
            </div>
            <!-- 
			<div class="modal-footer">
              <button type="button" class="btn btn-success" id="btnConfirm" data-dismiss="confirm">确认</button>
              <button type="button" class="btn btn-danger" id="btn2Cancel" data-dismiss="modal">取消</button>
            </div>
			-->
        </div>
    </div>
</div>




</div>

<script type="text/javascript" src="keyboard.js"></script>
<script type="text/javascript">


$(document).ready(function() { //$(function($) {

    //init websocket
    webSocket_init();

});

function getQueryString(name) { 
	var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i"); 
	var r = window.location.search.substr(1).match(reg); 
	if (r != null) return unescape(r[2]); return null; 
} 

// ws
var socket;
var debug_log_detail=0;
var g_vars_domain_prefix=getQueryString("target");

console.log("log:target is ",g_vars_domain_prefix );
if (g_vars_domain_prefix == null)
{
	g_vars_domain_prefix="192.168.234.100:8888";
	g_vars_domain_prefix="127.0.0.1:8888";
}

function webSocket_init() {
    //show loading ...
    Popup_info_pop("loading", "show", 0);

	if (g_vars_domain_prefix=="")
	{
		g_vars_domain_prefix =window.location.host
	}
    console.log("log:host is ", g_vars_domain_prefix);
	
    var host = "ws://" + g_vars_domain_prefix + "/ws";
    try {
        socket = new WebSocket(host);
        socket.onopen = function(msg) {
            // stop show loading ...
            //Popup_info_pop("","hide",0);

            webSocket_send_msg("heartbeat from client browser");
            //setImmediate(function () {
            get_ui_state_fromServer_sync();
            //});

        };
        socket.onmessage = function(msg) {
            if (debug_log_detail==1)console.log(msg);

            do_recevi_message("webSocket", msg);

        };
        socket.onclose = function(msg) {
            console.log("Lose Connection!");

            setTimeout(function() {
                webSocket_init();
            }, 1000);
            socket = null;
        };
    } catch (ex) {
        console.log(ex);
    }

}

function webSocket_send_msg(msg) {

    if (!msg) {
        alert("Message can not be empty");
        return;
    }

    try {
        console.log("we send '" + msg + "' to websocket")
        socket.send(msg);
    } catch (ex) {
        console.log(ex);
    }
}

window.onbeforeunload = function() {
    try {
        socket.send('quit');
        socket.close();
        socket = null;
    } catch (ex) {
        console.log(ex);
    }
};




function onkey(event) {
    console.log("recevi key  ", event);
    if (event.keyCode == 13) {
        send();
    }
}
// ws end
/*
{"event":"Open", "info":{"result":"OK"}}
{"event":"OICNotify", "info":{"id":uuid, "rt":"oic.r.xxxx","value":, "old_value":}}
{"event":"TimeOut", "info":{"type":"ToAlarm"/"ToProtect"}}
{"event":"CountDown", "info":{"type":"ToAlarm"/"ToProtect", "seconds":xx}}
{"event":"StatusChanged", "info":{"action":"", "result":"OK"}}
*/
var g_debug_rece_websocket=0;
var g_debug_request_state=0;
function do_recevi_message(from, msg) {
    //console.error("do_recevi_message  ", from, msg.data);
    if (from == "webSocket") {
		if (debug_log_detail==1)console.log("do_recevi_message from webSocket msg.data.event ", JSON.parse(msg.data).event);
        
		if ( (JSON.parse(msg.data).event == "loop") || (JSON.parse(msg.data).event == "OICNotify")|| (JSON.parse(msg.data).event == "StatusChanged") )
		{
			console.info("recei webSocket msg.data.event ", JSON.parse(msg.data).event);
			g_debug_rece_websocket +=1;
			webSocket_send_msg("send ack"+ g_debug_rece_websocket);
            get_ui_state_fromServer();
        }

    }
	//else
    //    get_ui_state_fromServer();


}

var ui_state_will_tohide = ""
var ui_state_current_showing = ""
var ui_state_current_shown = ""
//		var ui_state_old=""
function get_ui_state_fromServer_sync() { //only for 1st when docment is load
    //Popup_info_pop("loading","show",0);
    setTimeout(function() {
        $.ajax({
            url: "http://"+g_vars_domain_prefix+"/get_status",
            dataType: 'json',
            async: false,
            cache: false,
            data: "sync_connect",
            success: function(data) {
                ui_state_check_or_show(data);
            },
            error: function(data) {
                setTimeout(function() {
                    get_ui_state_fromServer_sync();
                }, 1000);
            },
            complete: function(data) {
                Popup_info_pop("", "hide", 0);
            }

        });
    }, 2000);

}
//
function get_ui_state_fromServer() {
	g_debug_request_state += 1;
    $.ajax({
        url: "http://"+g_vars_domain_prefix+"/get_status",
        dataType: 'json',
		data: {
			ws_seq: g_debug_rece_websocket,
            gs_seq: g_debug_request_state,

        },
        async: true,
        cache: false,
        success: function(data) {
            ui_state_check_or_show(data);
        },
    });
}
</script>

<script type="text/javascript" src="layer2.js"></script>

<script type="text/javascript">
function ui_state_stop_window_all(json_data){

                win_protect_check_stop(json_data);
                win_protect_starting_stop(json_data);
                win_protected_stop(json_data);
                 win_unlock_protect_stop(json_data);

                win_alert_message_stop(json_data);

                win_bell_ring_stop(json_data);

                win_bell_view_stop(json_data);

}
function ui_state_stop_window(stop_win,json_data){
	switch (stop_win) {
            case "protect_check":
                win_protect_check_stop(json_data);
                break;
            case "protect_starting":
                win_protect_starting_stop(json_data);
                break;
            case "protected":
                win_protected_stop(json_data);
                break;
            case "unlock_protect":
                win_unlock_protect_stop(json_data);
                break;
            case "alert_message":
                win_alert_message_stop(json_data);
                break;
            case "bell_ring":
                win_bell_ring_stop(json_data);
                break;
            case "bell_view":
                win_bell_view_stop(json_data);
                break;
        }
}
function ui_state_check_or_show(json_data) {
    var isChecked_shouldShow = 0;
    var server_ui_state = json_data["status"];
	//console.log ( "return josn", JSON.stringify(json_data))
    console.info("<--lay2--> show >>> (" + server_ui_state +")");
    switch (server_ui_state) {
        case "protect_check":
            isChecked_shouldShow = win_protect_check_check_or_show(json_data);
            break;
        case "protect_starting":
            isChecked_shouldShow = win_protect_starting_check_or_show(json_data);
            break;
        case "protected":
            isChecked_shouldShow = win_protected_check_or_show(json_data);
            break;
        case "unlock_protect":
            isChecked_shouldShow = win_unlock_protect_check_or_show(json_data);
            break;
        case "alert_message":
            isChecked_shouldShow = win_alert_message_check_or_show(json_data);
            break;
        case "bell_ring":
            isChecked_shouldShow = win_bell_ring_check_or_show(json_data);
            break;
        case "bell_view":
            isChecked_shouldShow = win_bell_view_check_or_show(json_data);
            break;
    }
    if (debug_log_detail==1) console.log("ui_state_check_or_show  ", ui_state_current_shown, server_ui_state, isChecked_shouldShow);
    if ((isChecked_shouldShow == 1) && (ui_state_current_shown != server_ui_state)) {
       
        //old state must to stop
        ui_state_will_tohide = ui_state_current_shown;
		ui_state_stop_window_all(json_data);
		//ui_state_stop_window(ui_state_will_tohide,json_data);
        
        //show new state
		
		{

				var ui_state_will_tohide2=""
				if( (ui_state_current_showing != "") &&  (server_ui_state != ui_state_current_showing) )
				{
					console.error("!!!!refresh ui too quick ,current_showing (" + ui_state_current_showing+")server_ui_state("+server_ui_state+")current_shown( "+ui_state_current_shown+")");
					
					console.info("<--lay2--> hide <<< ("+ui_state_will_tohide +")");
					ui_state_will_tohide2 = ui_state_current_showing
					//ui_state_stop_window(ui_state_current_showing,json_data);
					
				}
				
				ui_state_current_showing = server_ui_state;
				$('#' + ui_state_current_showing).addClass("fade");
				$('#' + ui_state_current_showing).modal({backdrop:"static", keyboard: true})
							.modal("show");
				/*
				console.error( $('#' + ui_state_will_tohide) );
				if (ui_state_will_tohide != "")
				{
					console.info("<--lay2--> hide <<< ("+ui_state_will_tohide +")");
					setTimeout(function() {
							$('#' + ui_state_will_tohide).removeClass("fade");
							$('#' + ui_state_will_tohide).modal("hide");
							ui_state_will_tohide = "";
					}, 1000);
					//$('#' + ui_state_will_tohide).removeClass("fade");
					//$('#' + ui_state_will_tohide).modal("hide");
					
				}
				if (ui_state_will_tohide2 != "")
				{
					setTimeout(function() {
						$('#' + ui_state_will_tohide2).removeClass("fade");
						$('#' + ui_state_will_tohide2).modal("hide");
						ui_state_will_tohide2 = "";
					}, 1000);

				}
				*/

		 }
		 
			



        //!!!! when new state is shown ,ui_state_current_shown is changing and  oldstate to hide
    }

}

var pi_l2_all_win = new  Array("protect_check","protect_starting","protected","unlock_protect","alert_message","bell_ring","bell_view");
function system_close_last_window(pwin){

	//console.log("on shown event by " +pwin+": current_shown( "+ui_state_current_shown +") current_showing (" +ui_state_current_showing+")" );
	ui_state_current_shown =pwin;// ui_state_current_showing;
	ui_state_current_showing ="";
	 

	for ( num in pi_l2_all_win )
	{
		var l2_win = pi_l2_all_win[num];
		
		if (l2_win == ui_state_current_shown) {
			console.info("<--lay2--> check ",l2_win, "is current shown");
			continue;
		}
		var jquery_obj = $('#' + l2_win);
		if ( jquery_obj.hasClass("in"))
		{
			console.info("<--lay2--> hide2 <<< ("+l2_win +")");
			jquery_obj.removeClass("fade");
			jquery_obj.modal("hide");
		}

	}
	/* if (ui_state_will_tohide != "" && ui_state_will_tohide != ui_state_current_shown && ui_state_will_tohide != ui_state_current_shown )
	 {
		console.error("<--lay2--> hide2 <<< ("+ui_state_will_tohide +")");
		//"modal fade in" --> "modal fade" 
		//$('#' + ui_state_will_tohide).removeClass("fade");
 		$('#' + ui_state_will_tohide).modal("hide");

		ui_state_will_tohide = "";
	 }
	*/
	
}
</script>
<script type="text/javascript" src="layer3.js"></script>

</body>
</html>